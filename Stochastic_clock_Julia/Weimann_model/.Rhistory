inh_dm = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
inh_de = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
mic_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_All/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_ad = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_All/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_dr = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
mic_dm = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
mic_de = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
ast_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Ast_All/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_ad = read_xlsx("../Cyclops_ordering/downstream_output_Ast_All/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_dr = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
ast_dm = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
ast_de = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
GWAS_genes = c("ABCA1", "ABCA7", "ABI3", "ACE", "ADAM17", "ADAMTS1", "ANK3", "ANKH", "APH1B", "APP", "BCKDK", "BIN1", "BLNK", "CASS4", "CD2AP",
"CLNK", "CLU", "COX7C", "CR1", "CTSB", "CTSH", "DOC2A", "EED", "EPDR1", "EPHA1", "FERMT2", "FOXF1", "GRN", "HLA-DQA1", "HS3ST5",
"ICA1", "IDUA", "IGH", "IL34", "INPP5D", "JAZF1", "KLF16", "LILRB2", "MAF", "MINDY2", "MME", "MS4A4A", "MYO15A", "NCK2", "PLCG2",
"PLEKHA1", "PRDM7", "PRKD3", "PTK2B", "RASGEF1C", "RBCK1", "RHOH", "SCIMP", "SEC61G", "SHARPIN", "SIGLEC11", "SLC24A4", "SLC2A4RG",
"SNX1", "SORL1", "SORT1", "SPDYE3", "SPI1", "SPPL2A", "TMEM106B", "TNIP1", "TPCN1", "TREM2", "TREML2", "TSPAN14", "TSPOAP1",
"UMAD1", "UNC5CL", "USP6NL", "WDR12", "WDR81", "WNT3")
GWAS_genes = c(c("APOE", "PSEN1", "PSEN2"), GWAS_genes)
all_symbols = read_csv("../normed_counts/Pseudobulk_all_FiltByExprDefault_TMM.csv", show_col_types = F) %>% dplyr::select(Gene_Symbols) %>% unname %>% unlist
#AD GWAS Symbols not possible to find:
GWAS_genes[which(!(GWAS_genes %in% all_symbols))]
exc_de$`...1`
View(exc_de)
BHQCutoff
View(exc_de)
exc_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_ad = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_dr = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
exc_dm = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor")%>% dplyr::filter(BHQ < BHQCutoff)
exc_de = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr")%>% dplyr::filter(BHQ < BHQCutoff)
inh_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_ad = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_dr = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
inh_dm = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
inh_de = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
mic_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_ad = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_dr = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
mic_dm = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
mic_de = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
ast_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_ad = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_dr = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
ast_dm = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
ast_de = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
GWAS_genes = c("ABCA1", "ABCA7", "ABI3", "ACE", "ADAM17", "ADAMTS1", "ANK3", "ANKH", "APH1B", "APP", "BCKDK", "BIN1", "BLNK", "CASS4", "CD2AP",
"CLNK", "CLU", "COX7C", "CR1", "CTSB", "CTSH", "DOC2A", "EED", "EPDR1", "EPHA1", "FERMT2", "FOXF1", "GRN", "HLA-DQA1", "HS3ST5",
"ICA1", "IDUA", "IGH", "IL34", "INPP5D", "JAZF1", "KLF16", "LILRB2", "MAF", "MINDY2", "MME", "MS4A4A", "MYO15A", "NCK2", "PLCG2",
"PLEKHA1", "PRDM7", "PRKD3", "PTK2B", "RASGEF1C", "RBCK1", "RHOH", "SCIMP", "SEC61G", "SHARPIN", "SIGLEC11", "SLC24A4", "SLC2A4RG",
"SNX1", "SORL1", "SORT1", "SPDYE3", "SPI1", "SPPL2A", "TMEM106B", "TNIP1", "TPCN1", "TREM2", "TREML2", "TSPAN14", "TSPOAP1",
"UMAD1", "UNC5CL", "USP6NL", "WDR12", "WDR81", "WNT3")
GWAS_genes = c(c("APOE", "PSEN1", "PSEN2"), GWAS_genes)
all_symbols = read_csv("../normed_counts/Pseudobulk_all_FiltByExprDefault_TMM.csv", show_col_types = F) %>% dplyr::select(Gene_Symbols) %>% unname %>% unlist
#AD GWAS Symbols not possible to find:
GWAS_genes[which(!(GWAS_genes %in% all_symbols))]
View(exc_de)
#TREML2 and IGH not in my rosmap data so I will exclude those:
GWAS_genes = setdiff(GWAS_genes, c("TREML2", "IGH"))
supp_table = data.frame(AD_genes = GWAS_genes,
#Exc
Exc_ctl = GWAS_genes %in% exc_ctl$Gene_Symbols,
Exc_ad = GWAS_genes %in% exc_ad$Gene_Symbols,
Exc_dr = GWAS_genes %in% exc_dr$Gene_Symbols,
Exc_dm = GWAS_genes %in% exc_dm$Gene_Symbols,
Exc_de = GWAS_genes %in% exc_de$`...1`,
#Inhib
Inh_ctl = GWAS_genes %in% inh_ctl$Gene_Symbols,
Inh_ad = GWAS_genes %in% inh_ad$Gene_Symbols,
Inh_dr = GWAS_genes %in% inh_dr$Gene_Symbols,
Inh_dm = GWAS_genes %in% inh_dm$Gene_Symbols,
Inh_de = GWAS_genes %in% inh_de$`...1`,
#Ast
Ast_ctl = GWAS_genes %in% ast_ctl$Gene_Symbols,
Ast_ad = GWAS_genes %in% ast_ad$Gene_Symbols,
Ast_dr = GWAS_genes %in% ast_dr$Gene_Symbols,
Ast_dm = GWAS_genes %in% ast_dm$Gene_Symbols,
Ast_de = GWAS_genes %in% ast_de$`...1`,
#Micro
Mic_ctl = GWAS_genes %in% mic_ctl$Gene_Symbols,
Mic_ad = GWAS_genes %in% mic_ad$Gene_Symbols,
Mic_dr = GWAS_genes %in% mic_dr$Gene_Symbols,
Mic_dm = GWAS_genes %in% mic_dm$Gene_Symbols,
Mic_de = GWAS_genes %in% mic_de$`...1`)
colSums(supp_table[,-1])
supp_table <- supp_table %>%
mutate_all(~ ifelse(. == TRUE, "x", ifelse(. == FALSE, "", .)))
View(supp_table)
AmpRatioCutoff = 0.2
BHQCutoff = 0.1
AR_str = str_replace(toString(AmpRatioCutoff), "0\\.", "")
BHQ_str = str_replace(toString(BHQCutoff), "0\\.", "")
library(tidyverse)
library(readxl)
AmpRatioCutoff = 0.2
BHQCutoff = 0.1
AR_str = str_replace(toString(AmpRatioCutoff), "0\\.", "")
BHQ_str = str_replace(toString(BHQCutoff), "0\\.", "")
exc_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_ad = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_dr = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
exc_dm = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor")%>% dplyr::filter(BHQ < BHQCutoff)
exc_de = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr")%>% dplyr::filter(BHQ < BHQCutoff)
inh_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_ad = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_dr = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
inh_dm = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
inh_de = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
mic_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_ad = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_dr = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
mic_dm = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
mic_de = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
ast_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_ad = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_dr = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
ast_dm = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
ast_de = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
View(ast_ctl)
View(ast_ad)
View(ast_de)
View(ast_dm)
View(ast_dr)
View(exc_ad)
View(exc_ctl)
View(exc_dr)
View(exc_dm)
View(exc_de)
View(inh_ad)
View(inh_ctl)
View(inh_dr)
View(inh_dm)
View(inh_de)
View(mic_ad)
View(mic_ctl)
library(tidyverse)
library(readxl)
AmpRatioCutoff = 0.2
BHQCutoff = 0.1
AR_str = str_replace(toString(AmpRatioCutoff), "0\\.", "")
BHQ_str = str_replace(toString(BHQCutoff), "0\\.", "")
exc_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_ad = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_dr = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
exc_dm = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor")%>% dplyr::filter(BHQ < BHQCutoff)
exc_de = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr")%>% dplyr::filter(BHQ < BHQCutoff)
inh_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_ad = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_dr = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
inh_dm = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
inh_de = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
mic_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_ad = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_dr = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
mic_dm = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
mic_de = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
ast_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_ad = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_dr = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
ast_dm = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
ast_de = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
GWAS_genes = c("ABCA1", "ABCA7", "ABI3", "ACE", "ADAM17", "ADAMTS1", "ANK3", "ANKH", "APH1B", "APP", "BCKDK", "BIN1", "BLNK", "CASS4", "CD2AP",
"CLNK", "CLU", "COX7C", "CR1", "CTSB", "CTSH", "DOC2A", "EED", "EPDR1", "EPHA1", "FERMT2", "FOXF1", "GRN", "HLA-DQA1", "HS3ST5",
"ICA1", "IDUA", "IGH", "IL34", "INPP5D", "JAZF1", "KLF16", "LILRB2", "MAF", "MINDY2", "MME", "MS4A4A", "MYO15A", "NCK2", "PLCG2",
"PLEKHA1", "PRDM7", "PRKD3", "PTK2B", "RASGEF1C", "RBCK1", "RHOH", "SCIMP", "SEC61G", "SHARPIN", "SIGLEC11", "SLC24A4", "SLC2A4RG",
"SNX1", "SORL1", "SORT1", "SPDYE3", "SPI1", "SPPL2A", "TMEM106B", "TNIP1", "TPCN1", "TREM2", "TREML2", "TSPAN14", "TSPOAP1",
"UMAD1", "UNC5CL", "USP6NL", "WDR12", "WDR81", "WNT3")
GWAS_genes = c(c("APOE", "PSEN1", "PSEN2"), GWAS_genes)
all_symbols = read_csv("../normed_counts/Pseudobulk_all_FiltByExprDefault_TMM.csv", show_col_types = F) %>% dplyr::select(Gene_Symbols) %>% unname %>% unlist
#AD GWAS Symbols not possible to find:
GWAS_genes[which(!(GWAS_genes %in% all_symbols))]
#TREML2 and IGH not in my rosmap data so I will exclude those:
GWAS_genes = setdiff(GWAS_genes, c("TREML2", "IGH"))
supp_table = data.frame(AD_genes = GWAS_genes,
#Exc
Exc_ctl = GWAS_genes %in% exc_ctl$Gene_Symbols,
Exc_ad = GWAS_genes %in% exc_ad$Gene_Symbols,
Exc_dr = GWAS_genes %in% exc_dr$Gene_Symbols,
Exc_dm = GWAS_genes %in% exc_dm$Gene_Symbols,
Exc_de = GWAS_genes %in% exc_de$`...1`,
#Inhib
Inh_ctl = GWAS_genes %in% inh_ctl$Gene_Symbols,
Inh_ad = GWAS_genes %in% inh_ad$Gene_Symbols,
Inh_dr = GWAS_genes %in% inh_dr$Gene_Symbols,
Inh_dm = GWAS_genes %in% inh_dm$Gene_Symbols,
Inh_de = GWAS_genes %in% inh_de$`...1`,
#Ast
Ast_ctl = GWAS_genes %in% ast_ctl$Gene_Symbols,
Ast_ad = GWAS_genes %in% ast_ad$Gene_Symbols,
Ast_dr = GWAS_genes %in% ast_dr$Gene_Symbols,
Ast_dm = GWAS_genes %in% ast_dm$Gene_Symbols,
Ast_de = GWAS_genes %in% ast_de$`...1`,
#Micro
Mic_ctl = GWAS_genes %in% mic_ctl$Gene_Symbols,
Mic_ad = GWAS_genes %in% mic_ad$Gene_Symbols,
Mic_dr = GWAS_genes %in% mic_dr$Gene_Symbols,
Mic_dm = GWAS_genes %in% mic_dm$Gene_Symbols,
Mic_de = GWAS_genes %in% mic_de$`...1`)
colSums(supp_table[,-1])
supp_table <- supp_table %>%
mutate_all(~ ifelse(. == TRUE, "x", ifelse(. == FALSE, "", .)))
clear
colSums(supp_table[,-1])
View(supp_table)
supp_table %>% select(grep("_dr$|_dm$", colnames(supp_table))) %>% View
supp_table %>% select(grep("_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("_ctl$|_ad$", colnames(supp_table))) %>% View
supp_table %>% select(grep("_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_ctl$|_ad$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_dr$", colnames(supp_table))) %>% View
View(supp_table)
supp_table %>% select(grep("AD_genes|_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_dr$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_ctl$|_ad$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|Exc$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table))) %>% View
View(exc_dm)
View(exc_de)
library(tidyverse)
library(readxl)
AmpRatioCutoff = 0.2
BHQCutoff = 0.1
AR_str = str_replace(toString(AmpRatioCutoff), "0\\.", "")
BHQ_str = str_replace(toString(BHQCutoff), "0\\.", "")
exc_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_ad = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_dr = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
exc_dm = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor")%>% dplyr::filter(BHQ < BHQCutoff)
exc_de = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr")%>% dplyr::filter(BHQ < BHQCutoff)
inh_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_ad = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_dr = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
inh_dm = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
inh_de = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
mic_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_ad = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_dr = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
mic_dm = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
mic_de = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
ast_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_ad = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_dr = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
ast_dm = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
ast_de = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
GWAS_genes = c("ABCA1", "ABCA7", "ABI3", "ACE", "ADAM17", "ADAMTS1", "ANK3", "ANKH", "APH1B", "APP", "BCKDK", "BIN1", "BLNK", "CASS4", "CD2AP",
"CLNK", "CLU", "COX7C", "CR1", "CTSB", "CTSH", "DOC2A", "EED", "EPDR1", "EPHA1", "FERMT2", "FOXF1", "GRN", "HLA-DQA1", "HS3ST5",
"ICA1", "IDUA", "IGH", "IL34", "INPP5D", "JAZF1", "KLF16", "LILRB2", "MAF", "MINDY2", "MME", "MS4A4A", "MYO15A", "NCK2", "PLCG2",
"PLEKHA1", "PRDM7", "PRKD3", "PTK2B", "RASGEF1C", "RBCK1", "RHOH", "SCIMP", "SEC61G", "SHARPIN", "SIGLEC11", "SLC24A4", "SLC2A4RG",
"SNX1", "SORL1", "SORT1", "SPDYE3", "SPI1", "SPPL2A", "TMEM106B", "TNIP1", "TPCN1", "TREM2", "TREML2", "TSPAN14", "TSPOAP1",
"UMAD1", "UNC5CL", "USP6NL", "WDR12", "WDR81", "WNT3")
GWAS_genes = c(c("APOE", "PSEN1", "PSEN2"), GWAS_genes)
all_symbols = read_csv("../normed_counts/Pseudobulk_all_FiltByExprDefault_TMM.csv", show_col_types = F) %>% dplyr::select(Gene_Symbols) %>% unname %>% unlist
#AD GWAS Symbols not possible to find:
GWAS_genes[which(!(GWAS_genes %in% all_symbols))]
#TREML2 and IGH not in my rosmap data so I will exclude those:
GWAS_genes = setdiff(GWAS_genes, c("TREML2", "IGH"))
supp_table = data.frame(AD_genes = GWAS_genes,
#Exc
Exc_ctl = GWAS_genes %in% exc_ctl$Gene_Symbols,
Exc_ad = GWAS_genes %in% exc_ad$Gene_Symbols,
Exc_dr = GWAS_genes %in% exc_dr$Gene_Symbols,
Exc_dm = GWAS_genes %in% exc_dm$Gene_Symbols,
Exc_de = GWAS_genes %in% exc_de$`...1`,
#Inhib
Inh_ctl = GWAS_genes %in% inh_ctl$Gene_Symbols,
Inh_ad = GWAS_genes %in% inh_ad$Gene_Symbols,
Inh_dr = GWAS_genes %in% inh_dr$Gene_Symbols,
Inh_dm = GWAS_genes %in% inh_dm$Gene_Symbols,
Inh_de = GWAS_genes %in% inh_de$`...1`,
#Ast
Ast_ctl = GWAS_genes %in% ast_ctl$Gene_Symbols,
Ast_ad = GWAS_genes %in% ast_ad$Gene_Symbols,
Ast_dr = GWAS_genes %in% ast_dr$Gene_Symbols,
Ast_dm = GWAS_genes %in% ast_dm$Gene_Symbols,
Ast_de = GWAS_genes %in% ast_de$`...1`,
#Micro
Mic_ctl = GWAS_genes %in% mic_ctl$Gene_Symbols,
Mic_ad = GWAS_genes %in% mic_ad$Gene_Symbols,
Mic_dr = GWAS_genes %in% mic_dr$Gene_Symbols,
Mic_dm = GWAS_genes %in% mic_dm$Gene_Symbols,
Mic_de = GWAS_genes %in% mic_de$`...1`)
colSums(supp_table[,-1])
supp_table <- supp_table %>%
mutate_all(~ ifelse(. == TRUE, "x", ifelse(. == FALSE, "", .)))
supp_table %>% select(grep("AD_genes|_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_ctl$|_ad$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_dr$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table))) %>% View
library(tidyverse)
library(readxl)
AmpRatioCutoff = 0.2
BHQCutoff = 0.1
AR_str = str_replace(toString(AmpRatioCutoff), "0\\.", "")
BHQ_str = str_replace(toString(BHQCutoff), "0\\.", "")
exc_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_ad = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_dr = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
exc_dm = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor")%>% dplyr::filter(BHQ < BHQCutoff)
exc_de = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr")%>% dplyr::filter(BHQ < BHQCutoff)
inh_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_ad = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_dr = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
inh_dm = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
inh_de = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
mic_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_ad = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_dr = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
mic_dm = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
mic_de = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
ast_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_ad = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_dr = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
ast_dm = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
ast_de = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
GWAS_genes = c("ABCA1", "ABCA7", "ABI3", "ACE", "ADAM17", "ADAMTS1", "ANK3", "ANKH", "APH1B", "APP", "BCKDK", "BIN1", "BLNK", "CASS4", "CD2AP",
"CLNK", "CLU", "COX7C", "CR1", "CTSB", "CTSH", "DOC2A", "EED", "EPDR1", "EPHA1", "FERMT2", "FOXF1", "GRN", "HLA-DQA1", "HS3ST5",
"ICA1", "IDUA", "IGH", "IL34", "INPP5D", "JAZF1", "KLF16", "LILRB2", "MAF", "MINDY2", "MME", "MS4A4A", "MYO15A", "NCK2", "PLCG2",
"PLEKHA1", "PRDM7", "PRKD3", "PTK2B", "RASGEF1C", "RBCK1", "RHOH", "SCIMP", "SEC61G", "SHARPIN", "SIGLEC11", "SLC24A4", "SLC2A4RG",
"SNX1", "SORL1", "SORT1", "SPDYE3", "SPI1", "SPPL2A", "TMEM106B", "TNIP1", "TPCN1", "TREM2", "TREML2", "TSPAN14", "TSPOAP1",
"UMAD1", "UNC5CL", "USP6NL", "WDR12", "WDR81", "WNT3")
GWAS_genes = c(c("APOE", "PSEN1", "PSEN2"), GWAS_genes)
all_symbols = read_csv("../normed_counts/Pseudobulk_all_FiltByExprDefault_TMM.csv", show_col_types = F) %>% dplyr::select(Gene_Symbols) %>% unname %>% unlist
#AD GWAS Symbols not possible to find:
GWAS_genes[which(!(GWAS_genes %in% all_symbols))]
#TREML2 and IGH not in my rosmap data so I will exclude those:
GWAS_genes = setdiff(GWAS_genes, c("TREML2", "IGH"))
supp_table = data.frame(AD_genes = GWAS_genes,
#Exc
Exc_ctl = GWAS_genes %in% exc_ctl$Gene_Symbols,
Exc_ad = GWAS_genes %in% exc_ad$Gene_Symbols,
Exc_dr = GWAS_genes %in% exc_dr$Gene_Symbols,
Exc_dm = GWAS_genes %in% exc_dm$Gene_Symbols,
Exc_de = GWAS_genes %in% exc_de$`...1`,
#Inhib
Inh_ctl = GWAS_genes %in% inh_ctl$Gene_Symbols,
Inh_ad = GWAS_genes %in% inh_ad$Gene_Symbols,
Inh_dr = GWAS_genes %in% inh_dr$Gene_Symbols,
Inh_dm = GWAS_genes %in% inh_dm$Gene_Symbols,
Inh_de = GWAS_genes %in% inh_de$`...1`,
#Ast
Ast_ctl = GWAS_genes %in% ast_ctl$Gene_Symbols,
Ast_ad = GWAS_genes %in% ast_ad$Gene_Symbols,
Ast_dr = GWAS_genes %in% ast_dr$Gene_Symbols,
Ast_dm = GWAS_genes %in% ast_dm$Gene_Symbols,
Ast_de = GWAS_genes %in% ast_de$`...1`,
#Micro
Mic_ctl = GWAS_genes %in% mic_ctl$Gene_Symbols,
Mic_ad = GWAS_genes %in% mic_ad$Gene_Symbols,
Mic_dr = GWAS_genes %in% mic_dr$Gene_Symbols,
Mic_dm = GWAS_genes %in% mic_dm$Gene_Symbols,
Mic_de = GWAS_genes %in% mic_de$`...1`)
colSums(supp_table[,-1])
supp_table <- supp_table %>%
mutate_all(~ ifelse(. == TRUE, "x", ifelse(. == FALSE, "", .)))
supp_table %>% select(grep("AD_genes|_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_ctl$|_ad$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_dr$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table))) %>% View
colnames(supp_table) = c("AD GWAS Genes",
"Excitatory Neurons cycling CTL",
"Excitatory Neurons cycling AD",
"Excitatory Neurons diff. rhyth.",
"Excitatory Neurons diff. mesor",
"Excitatory Neurons diff. expr.",
"Inhibitory Neurons cycling CTL",
"Inhibitory Neurons cycling AD",
"Inhibitory Neurons diff. rhyth.",
"Inhibitory Neurons diff. mesor",
"Inhibitory Neurons diff. expr",
"Astrocytes cycling CTL",
"Astrocytes cycling AD",
"Astrocytes diff. rhyth.",
"Astrocytes diff. mesor",
"Astrocytes diff. expr.",
"Microglia cycling CTL",
"Microglia cycling AD",
"Microglia diff. rhyth.",
"Microglia diff. mesor",
"Microglia diff. expr.")
library(writexl)
write_xlsx(supp_table, paste0("~/Desktop/Cycling_GWAS_AR",AR_str,"BHQ", BHQ_str, ".xlsx"), col_names = T)
exc_neurons_only = supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table)))
write.table(exc_neurons_only, "~/Desktop/AD_GWAS_exc.csv", col_names = F)
exc_neurons_only = supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table)))
write.table(exc_neurons_only, "~/Desktop/AD_GWAS_exc.csv", col.names = F)
exc_neurons_only = supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table)))
write.table(exc_neurons_only, "~/Desktop/AD_GWAS_exc.csv",sep = ',', col.names = F)
exc_neurons_only = supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table)))
write.table(exc_neurons_only, "~/Desktop/AD_GWAS_exc.csv",sep = ',', row.names = F)
library(tidyverse)
library(readxl)
AmpRatioCutoff = 0.2
BHQCutoff = 0.1
AR_str = str_replace(toString(AmpRatioCutoff), "0\\.", "")
BHQ_str = str_replace(toString(BHQCutoff), "0\\.", "")
exc_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_ad = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling") %>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
exc_dr = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
exc_dm = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor")%>% dplyr::filter(BHQ < BHQCutoff)
exc_de = read_xlsx("../Cyclops_ordering/downstream_output_Exc_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr")%>% dplyr::filter(BHQ < BHQCutoff)
inh_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_ad = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
inh_dr = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
inh_dm = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
inh_de = read_xlsx("../Cyclops_ordering/downstream_output_Inhib_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
mic_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_ad = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
mic_dr = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
mic_dm = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
mic_de = read_xlsx("../Cyclops_ordering/downstream_output_Mglia_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
ast_ctl = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_CTL_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_ad = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_AD_cycling")%>% dplyr::filter(amp_ratio >= AmpRatioCutoff & BHQ < BHQCutoff)
ast_dr = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_rhyth") %>% dplyr::filter(BHQ < BHQCutoff)
ast_dm = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_mesor") %>% dplyr::filter(BHQ < BHQCutoff)
ast_de = read_xlsx("../Cyclops_ordering/downstream_output_Ast_all/AD_GWAS_diff_rhythms_CyclingBHQ1.xlsx", sheet = "GWAS_diff_expr") %>% dplyr::filter(BHQ < BHQCutoff)
GWAS_genes = c("ABCA1", "ABCA7", "ABI3", "ACE", "ADAM17", "ADAMTS1", "ANK3", "ANKH", "APH1B", "APP", "BCKDK", "BIN1", "BLNK", "CASS4", "CD2AP",
"CLNK", "CLU", "COX7C", "CR1", "CTSB", "CTSH", "DOC2A", "EED", "EPDR1", "EPHA1", "FERMT2", "FOXF1", "GRN", "HLA-DQA1", "HS3ST5",
"ICA1", "IDUA", "IGH", "IL34", "INPP5D", "JAZF1", "KLF16", "LILRB2", "MAF", "MINDY2", "MME", "MS4A4A", "MYO15A", "NCK2", "PLCG2",
"PLEKHA1", "PRDM7", "PRKD3", "PTK2B", "RASGEF1C", "RBCK1", "RHOH", "SCIMP", "SEC61G", "SHARPIN", "SIGLEC11", "SLC24A4", "SLC2A4RG",
"SNX1", "SORL1", "SORT1", "SPDYE3", "SPI1", "SPPL2A", "TMEM106B", "TNIP1", "TPCN1", "TREM2", "TREML2", "TSPAN14", "TSPOAP1",
"UMAD1", "UNC5CL", "USP6NL", "WDR12", "WDR81", "WNT3")
GWAS_genes = c(c("APOE", "PSEN1", "PSEN2"), GWAS_genes)
all_symbols = read_csv("../normed_counts/Pseudobulk_all_FiltByExprDefault_TMM.csv", show_col_types = F) %>% dplyr::select(Gene_Symbols) %>% unname %>% unlist
#AD GWAS Symbols not possible to find:
GWAS_genes[which(!(GWAS_genes %in% all_symbols))]
#TREML2 and IGH not in my rosmap data so I will exclude those:
GWAS_genes = setdiff(GWAS_genes, c("TREML2", "IGH"))
supp_table = data.frame(AD_genes = GWAS_genes,
#Exc
Exc_ctl = GWAS_genes %in% exc_ctl$Gene_Symbols,
Exc_ad = GWAS_genes %in% exc_ad$Gene_Symbols,
Exc_dr = GWAS_genes %in% exc_dr$Gene_Symbols,
Exc_dm = GWAS_genes %in% exc_dm$Gene_Symbols,
Exc_de = GWAS_genes %in% exc_de$`...1`,
#Inhib
Inh_ctl = GWAS_genes %in% inh_ctl$Gene_Symbols,
Inh_ad = GWAS_genes %in% inh_ad$Gene_Symbols,
Inh_dr = GWAS_genes %in% inh_dr$Gene_Symbols,
Inh_dm = GWAS_genes %in% inh_dm$Gene_Symbols,
Inh_de = GWAS_genes %in% inh_de$`...1`,
#Ast
Ast_ctl = GWAS_genes %in% ast_ctl$Gene_Symbols,
Ast_ad = GWAS_genes %in% ast_ad$Gene_Symbols,
Ast_dr = GWAS_genes %in% ast_dr$Gene_Symbols,
Ast_dm = GWAS_genes %in% ast_dm$Gene_Symbols,
Ast_de = GWAS_genes %in% ast_de$`...1`,
#Micro
Mic_ctl = GWAS_genes %in% mic_ctl$Gene_Symbols,
Mic_ad = GWAS_genes %in% mic_ad$Gene_Symbols,
Mic_dr = GWAS_genes %in% mic_dr$Gene_Symbols,
Mic_dm = GWAS_genes %in% mic_dm$Gene_Symbols,
Mic_de = GWAS_genes %in% mic_de$`...1`)
colSums(supp_table[,-1])
supp_table <- supp_table %>%
mutate_all(~ ifelse(. == TRUE, "x", ifelse(. == FALSE, "", .)))
supp_table %>% select(grep("AD_genes|_dm$|_de$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_ctl$|_ad$", colnames(supp_table))) %>% View
supp_table %>% select(grep("AD_genes|_dr$", colnames(supp_table))) %>% View
exc_neurons_only = supp_table %>% select(grep("AD_genes|^Exc", colnames(supp_table)))
write.table(exc_neurons_only, "~/Desktop/AD_GWAS_exc.csv",sep = ',', row.names = F)
library(reticulate) #use to find conda env for python
library(tidyverse)
source("./downstream_helpers/differential_rhyth_generalized.R")
source("./downstream_helpers/create_rnk_files.R")
source("./downstream_helpers/fgsea.R")
source("./downstream_helpers/Files_for_Pscan.R")
source("./downstream_helpers/Make_KEGG_map_files.R")
source("./downstream_helpers/Check_TF_for_cycling_or_DR.R")
source("./downstream_helpers/plot_clock_face_plots.R")
source("./downstream_helpers/plot_gene_traces_generalized.R")
source("./downstream_helpers/order_metabolon.R")
source("./downstream_helpers/order_proteomics.R")
setwd(path_to_cyclops_ordering)
#path to cyclops ordering
path_to_cyclops_ordering = "../Cyclops_ordering/"
#path to normalized counts
path_to_tmm_file = "../normed_counts/Exc_all_FiltByExprDefault_TMM.csv"
# optional path to file containing differential expression results
edgeR_de_filename = "../edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv"
path_to_rosmap_clin = "../ROSMAP_metadata/cleaned_rosmapmeta_n409.csv"
metabolon_filename = "../metabolic_data/ROSMAP_Metabolon_HD4_Brain514_assay_data.csv"
metabolon_datakey = "../metabolic_data/ROSMAP_Metabolon_HD4_Data_Dictionary.csv"
#BHQ corrected p cutoff to be considered cycling in analysis:
isCyclingBHQCutoff = 0.1
percentile = 0.
useBatch = T
#Ribosome genes
plot_me = c("RPL18","RPS7","RPL22","RPS18","RPL8","RPL10A","RPS13","RPL14","RPS15A","RPS12","RPL36AL","RPL34","RPL30","RPL9","RPL21","RPS28","RPSA","RPL26","RPL27A","FAU","RPS3A","RPL7A","RPL17","RPS27A","RPS16","RPL15","RPLP1","RPL7","RPL10","RPL23A","RPL18A","RPL3","RPL12","RPL39","RPL37A","RPL37","RPS10","RPL13","RPL35A","RPS23","RPL13A","RPL38","RPS29","RPL24","RPL41","RPL35","RPS26","RPS2","RPS9","RPL32","RPL6","RPS21","RPS24","RPS25","RPL36","RPL19","RPS27","RPL29","RPS15","RPS3","RPS5","RPS8","RPL27","RSL24D1","RPS6","RPL11")
#Add oxphos genes
plot_me = c(plot_me, "ATP6V1G1","UQCR10","NDUFA5","NDUFA4" ,"COX6CP3",   "PPA2","ATP5MF","NDUFS7", "MT-CYB", "ATP6V0A1","ATP6V1G2","ATP6V0B", "ATP5PO","MT-CO2","MT-CO1","ATP6AP1","COX8C","MT-CO3" ,"COX5B", "COX4I1",  "ATP6V0A4" ,"ATP12A","MT-ATP6","MT-ATP8" ,"ATP5PD", "NDUFA2","NDUFA3",    "NDUFA1", "ATP5MC1P5","UQCRQ","ATP6V1H","ATP5F1D"  ,"LHPP","ATP6V0D2" ,"COX7A2L" ,"ATP5MC3","ATP6V1C2","ATP5MC2" ,"ATP5MC1" ,"ATP5PB" ,"ATP5F1E", "COX5A" ,"TCIRG1","UQCRHL" ,"ATP4B" ,"ATP6V1D" )
plot_me = c("COX7C", "SEC61G", "CLU", "JAZF1", "KLF16")
plot_genes(path_to_tmm_file, path_to_cyclops_ordering, plot_me,useBatch = useBatch, percentile = percentile, split_cond_plots = T)
#Ribosome genes
plot_me = c("RPL18","RPS7","RPL22","RPS18","RPL8","RPL10A","RPS13","RPL14","RPS15A","RPS12","RPL36AL","RPL34","RPL30","RPL9","RPL21","RPS28","RPSA","RPL26","RPL27A","FAU","RPS3A","RPL7A","RPL17","RPS27A","RPS16","RPL15","RPLP1","RPL7","RPL10","RPL23A","RPL18A","RPL3","RPL12","RPL39","RPL37A","RPL37","RPS10","RPL13","RPL35A","RPS23","RPL13A","RPL38","RPS29","RPL24","RPL41","RPL35","RPS26","RPS2","RPS9","RPL32","RPL6","RPS21","RPS24","RPS25","RPL36","RPL19","RPS27","RPL29","RPS15","RPS3","RPS5","RPS8","RPL27","RSL24D1","RPS6","RPL11")
#Add oxphos genes
plot_me = c(plot_me, "ATP6V1G1","UQCR10","NDUFA5","NDUFA4" ,"COX6CP3",   "PPA2","ATP5MF","NDUFS7", "MT-CYB", "ATP6V0A1","ATP6V1G2","ATP6V0B", "ATP5PO","MT-CO2","MT-CO1","ATP6AP1","COX8C","MT-CO3" ,"COX5B", "COX4I1",  "ATP6V0A4" ,"ATP12A","MT-ATP6","MT-ATP8" ,"ATP5PD", "NDUFA2","NDUFA3",    "NDUFA1", "ATP5MC1P5","UQCRQ","ATP6V1H","ATP5F1D"  ,"LHPP","ATP6V0D2" ,"COX7A2L" ,"ATP5MC3","ATP6V1C2","ATP5MC2" ,"ATP5MC1" ,"ATP5PB" ,"ATP5F1E", "COX5A" ,"TCIRG1","UQCRHL" ,"ATP4B" ,"ATP6V1D" )
plot_me = c("COX7C", "SEC61G", "CLU", "JAZF1", "KLF16")
plot_genes(path_to_tmm_file, path_to_cyclops_ordering, plot_me,useBatch = useBatch, percentile = percentile, split_cond_plots = F)
#Ribosome genes
plot_me = c("RPL18","RPS7","RPL22","RPS18","RPL8","RPL10A","RPS13","RPL14","RPS15A","RPS12","RPL36AL","RPL34","RPL30","RPL9","RPL21","RPS28","RPSA","RPL26","RPL27A","FAU","RPS3A","RPL7A","RPL17","RPS27A","RPS16","RPL15","RPLP1","RPL7","RPL10","RPL23A","RPL18A","RPL3","RPL12","RPL39","RPL37A","RPL37","RPS10","RPL13","RPL35A","RPS23","RPL13A","RPL38","RPS29","RPL24","RPL41","RPL35","RPS26","RPS2","RPS9","RPL32","RPL6","RPS21","RPS24","RPS25","RPL36","RPL19","RPS27","RPL29","RPS15","RPS3","RPS5","RPS8","RPL27","RSL24D1","RPS6","RPL11")
#Add oxphos genes
plot_me = c(plot_me, "ATP6V1G1","UQCR10","NDUFA5","NDUFA4" ,"COX6CP3",   "PPA2","ATP5MF","NDUFS7", "MT-CYB", "ATP6V0A1","ATP6V1G2","ATP6V0B", "ATP5PO","MT-CO2","MT-CO1","ATP6AP1","COX8C","MT-CO3" ,"COX5B", "COX4I1",  "ATP6V0A4" ,"ATP12A","MT-ATP6","MT-ATP8" ,"ATP5PD", "NDUFA2","NDUFA3",    "NDUFA1", "ATP5MC1P5","UQCRQ","ATP6V1H","ATP5F1D"  ,"LHPP","ATP6V0D2" ,"COX7A2L" ,"ATP5MC3","ATP6V1C2","ATP5MC2" ,"ATP5MC1" ,"ATP5PB" ,"ATP5F1E", "COX5A" ,"TCIRG1","UQCRHL" ,"ATP4B" ,"ATP6V1D" )
plot_me = c("COX7C", "SEC61G", "CLU", "JAZF1", "KLF16")
plot_genes(path_to_tmm_file, path_to_cyclops_ordering, plot_me,useBatch = useBatch, percentile = percentile, split_cond_plots = F, save_pdf = T)
#Ribosome genes
plot_me = c("RPL18","RPS7","RPL22","RPS18","RPL8","RPL10A","RPS13","RPL14","RPS15A","RPS12","RPL36AL","RPL34","RPL30","RPL9","RPL21","RPS28","RPSA","RPL26","RPL27A","FAU","RPS3A","RPL7A","RPL17","RPS27A","RPS16","RPL15","RPLP1","RPL7","RPL10","RPL23A","RPL18A","RPL3","RPL12","RPL39","RPL37A","RPL37","RPS10","RPL13","RPL35A","RPS23","RPL13A","RPL38","RPS29","RPL24","RPL41","RPL35","RPS26","RPS2","RPS9","RPL32","RPL6","RPS21","RPS24","RPS25","RPL36","RPL19","RPS27","RPL29","RPS15","RPS3","RPS5","RPS8","RPL27","RSL24D1","RPS6","RPL11")
#Add oxphos genes
plot_me = c(plot_me, "ATP6V1G1","UQCR10","NDUFA5","NDUFA4" ,"COX6CP3",   "PPA2","ATP5MF","NDUFS7", "MT-CYB", "ATP6V0A1","ATP6V1G2","ATP6V0B", "ATP5PO","MT-CO2","MT-CO1","ATP6AP1","COX8C","MT-CO3" ,"COX5B", "COX4I1",  "ATP6V0A4" ,"ATP12A","MT-ATP6","MT-ATP8" ,"ATP5PD", "NDUFA2","NDUFA3",    "NDUFA1", "ATP5MC1P5","UQCRQ","ATP6V1H","ATP5F1D"  ,"LHPP","ATP6V0D2" ,"COX7A2L" ,"ATP5MC3","ATP6V1C2","ATP5MC2" ,"ATP5MC1" ,"ATP5PB" ,"ATP5F1E", "COX5A" ,"TCIRG1","UQCRHL" ,"ATP4B" ,"ATP6V1D" )
plot_me = c("COX7C", "SEC61G", "CLU", "JAZF1", "KLF16", "ARNTL")
plot_genes(path_to_tmm_file, path_to_cyclops_ordering, plot_me,useBatch = useBatch, percentile = percentile, split_cond_plots = F, save_pdf = T)
