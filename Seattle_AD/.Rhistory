Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
View(Col_seattle_de_merge)
View(Col_seattle_de_merge)
library(tidyverse)
Col_DR = read_csv("../scROSMAP_project/Cyclops_ordering/downstream_output_Exc_all/diff_rhythms_CyclingBHQ1AmpRatio1.csv", show_col_types = F)
Col_DR_ribo = dplyr::filter(Col_DR, grepl("^RP[SL]", Gene_Symbols))
Col_DR_ribo_genes = select(Col_DR_ribo, Gene_Symbols) %>% unlist %>% unname
seattle_EN = read_csv("seattle_ad_deseq2_results_A9.csv")
seattle_EN_filt = dplyr::filter(seattle_EN, `...1` %in% Col_DR_ribo_genes)
hist(seattle_EN_filt$log2FoldChange, xlab = "Excitatory Neurons SEA-AD Ribo genes L2FC", main = "DR Ribosome Genes from Columbia shown in SEA-AD")
df_merge = merge(seattle_EN_filt, Col_DR_ribo, by.x = "...1", by.y= "Gene_Symbols")
ggplot(df_merge, aes(log2FoldChange, Log_AD_CTL_ampRatio))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP Log(AD/CTL) amp. ratio")
cor(df_merge$log2FoldChange, df_merge$Log_AD_CTL_ampRatio)
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
View(Col_seattle_de_merge)
library(tidyverse)
Col_DR = read_csv("../scROSMAP_project/Cyclops_ordering/downstream_output_Exc_all/diff_rhythms_CyclingBHQ1AmpRatio1.csv", show_col_types = F)
Col_DR_ribo = dplyr::filter(Col_DR, grepl("^RP[SL]", Gene_Symbols))
Col_DR_ribo_genes = select(Col_DR_ribo, Gene_Symbols) %>% unlist %>% unname
seattle_EN = read_csv("seattle_ad_deseq2_results_A9.csv")
seattle_EN_filt = dplyr::filter(seattle_EN, `...1` %in% Col_DR_ribo_genes)
hist(seattle_EN_filt$log2FoldChange, xlab = "Excitatory Neurons SEA-AD Ribo genes L2FC", main = "DR Ribosome Genes from Columbia shown in SEA-AD")
df_merge = merge(seattle_EN_filt, Col_DR_ribo, by.x = "...1", by.y= "Gene_Symbols")
ggplot(df_merge, aes(log2FoldChange, Log_AD_CTL_ampRatio))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP Log(AD/CTL) amp. ratio")
cor(df_merge$log2FoldChange, df_merge$Log_AD_CTL_ampRatio)
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
Col_DM = read_csv("../scROSMAP_project/Cyclops_ordering/downstream_output_Exc_all/differential_mesor_all_genes.csv", show_col_types = F)
Col_DM_ribo = dplyr::filter(Col_DM, grepl("^RP[SL]", `Gene_Symbols`)) %>% mutate(LFC = log2(as.numeric(mesor_AD)/as.numeric(mesor_CTL)) )
Col_seattle_dm_merge = merge(Col_DM_ribo, seattle_EN, by.x = "Gene_Symbols", by.y = "...1")
ggplot(Col_seattle_dm_merge, aes(log2FoldChange, LFC))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP Log2(MESOR AD/ MESOR CTL)")
cor(Col_seattle_dm_merge$LFC, Col_seattle_dm_merge$log2FoldChange)
View(zv)
View(Col_seattle_dm_merge)
View(df_merge)
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC, color = `...1` %in% highlight_genes))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC, color = `...1` %in% highlight_genes))+
geom_point()+
theme_minimal()+
scale_color_manual(values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC, color = `...1` %in% highlight_genes))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, )+
geom_point()+
theme_minimal()+
# scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
library(tidyverse)
seattle_EN = read_csv("seattle_ad_deseq2_results_A9.csv")
seattle_EN_filt = dplyr::filter(seattle_EN, `...1` %in% Col_DR_ribo_genes)
library(tidyverse)
Col_DR = read_csv("../scROSMAP_project/Cyclops_ordering/downstream_output_Exc_all/diff_rhythms_CyclingBHQ1AmpRatio1.csv", show_col_types = F)
Col_DR_ribo = dplyr::filter(Col_DR, grepl("^RP[SL]", Gene_Symbols))
Col_DR_ribo_genes = select(Col_DR_ribo, Gene_Symbols) %>% unlist %>% unname
library(tidyverse)
seattle_EN = read_csv("seattle_ad_deseq2_results_A9.csv")
seattle_EN_filt = dplyr::filter(seattle_EN, `...1` %in% Col_DR_ribo_genes)
View(seattle_EN)
library(tidyverse)
seattle_EN = read_csv("seattle_ad_deseq2_results_A9.csv")
# seattle_EN_filt = dplyr::filter(seattle_EN, `...1` %in% Col_DR_ribo_genes)
# hist(seattle_EN_filt$log2FoldChange, xlab = "Excitatory Neurons SEA-AD Ribo genes L2FC", main = "DR Ribosome Genes from Columbia shown in SEA-AD")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, )+
geom_point()+
theme_minimal()+
# scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
# scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
Vie(Col_seattle_de_merge)
View(Col_seattle_de_merge)
{r}
ggplot(Col_seattle_de_merge, aes(PValue, pvalue))+
geom_point()+
theme_minimal()+
# scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab(" ")+
ylab("")
ggplot(Col_seattle_de_merge, aes(-log(PValue), -log(pvalue)))+
geom_point()+
theme_minimal()+
# scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab(" ")+
ylab("")
Col_DM = read_csv("../scROSMAP_project/Cyclops_ordering/downstream_output_Exc_all/differential_mesor_all_genes.csv", show_col_types = F)
Col_DM_ribo = dplyr::filter(Col_DM, grepl("^RP[SL]", `Gene_Symbols`)) %>% mutate(LFC = log2(as.numeric(mesor_AD)/as.numeric(mesor_CTL)) )
Col_seattle_dm_merge = merge(Col_DM_ribo, seattle_EN, by.x = "Gene_Symbols", by.y = "...1")
ggplot(Col_seattle_dm_merge, aes(log2FoldChange, LFC))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP Log2(MESOR AD/ MESOR CTL)")
cor(Col_seattle_dm_merge$LFC, Col_seattle_dm_merge$log2FoldChange)
View(Col_seattle_dm_merge)
ggplot(Col_seattle_dm_merge, aes(-log(p_mesor), -log(pvalue)))+
geom_point()+
theme_minimal()+
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("ROSMAP DM p-value")+
ylab("Seattle-AD DE p-value")
View(Col_DE)
View(Col_DM)
test = merge(Col_DE, Col_DM)
View(Col_DE)
View(Col_DM)
test = merge(Col_DE, Col_DM, by.x ="...1", by.y = "Gene_Symbols" )
View(test)
View(test)
test = merge(Col_DE, Col_DM, by.x ="...1", by.y = "Gene_Symbols" ) %>% dplyr::filter( grepl("^RP[SL]", `...1`))
plot(-log(test$PValue), -log(test$p_mesor))
library(tidyverse)
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
seattle_EN = read_csv("seattle_ad_deseq2_results_A9.csv")
# seattle_EN_filt = dplyr::filter(seattle_EN, `...1` %in% Col_DR_ribo_genes)
#
# hist(seattle_EN_filt$log2FoldChange, xlab = "Excitatory Neurons SEA-AD Ribo genes L2FC", main = "DR Ribosome Genes from Columbia shown in SEA-AD")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 5, width = 5, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 6, width = 6, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 12),      # Title font size
axis.title = element_text(size = 12),     # Axis title font size
axis.text = element_text(size = 12),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 12)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 6, width = 6, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 6, width = 6, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 8, width = 8, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 5, width = 6, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")+
xlim(c(-0.3, 0.31))
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 5, width = 6, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")+
xlim(c(-0.3, 0.35))+
ylim(c(-0.3, 0.35))
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 5, width = 5, units = "in")
Col_DE = read_csv("../scROSMAP_project/edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv", show_col_types = F)
Col_DE_ribo = dplyr::filter(Col_DE, grepl("^RP[SL]", `...1`))
Col_seattle_de_merge = merge(Col_DE_ribo, seattle_EN, by = "...1")
highlight_genes = c("RPS6", "RPS27A", "RPL7A", "RPL10A")
ggplot(Col_seattle_de_merge, aes(log2FoldChange, logFC))+
geom_point()+
theme_minimal()+
scale_color_manual(name = "Selected genes", values = c("TRUE" = "red", "FALSE" = "black")) +
theme(
plot.title = element_text(size = 20),      # Title font size
axis.title = element_text(size = 14),     # Axis title font size
axis.text = element_text(size = 14),      # Axis text font size
legend.text = element_text(size = 12),    # Legend text font size
legend.title = element_text(size = 14)    # Legend title font size
)+
xlab("SEAAD L2FC")+
ylab("ROSMAP L2FC")+
xlim(c(-0.3, 0.32))+
ylim(c(-0.3, 0.32))
cor(Col_seattle_de_merge$logFC, Col_seattle_de_merge$log2FoldChange)
ggsave("~/Desktop/SEAD_DE_vs_ROSMAP_DE_cor0_704.pdf", device = "pdf", height = 5, width = 5, units = "in")
library(reticulate) #use to find conda env for python
library(tidyverse)
source("./downstream_helpers/differential_rhyth_generalized.R")
source("./downstream_helpers/create_rnk_files.R")
source("./downstream_helpers/fgsea.R")
source("./downstream_helpers/Files_for_Pscan.R")
source("./downstream_helpers/Make_KEGG_map_files.R")
source("./downstream_helpers/Check_TF_for_cycling_or_DR.R")
source("./downstream_helpers/plot_clock_face_plots.R")
source("./downstream_helpers/plot_gene_traces_generalized.R")
source("./downstream_helpers/order_metabolon.R")
source("./downstream_helpers/order_proteomics.R")
#path to cyclops ordering
path_to_cyclops_ordering = "../Cyclops_ordering/"
#path to normalized counts
path_to_tmm_file = "../normed_counts/Exc_all_FiltByExprDefault_TMM.csv"
# optional path to file containing differential expression results
# edgeR_de_filename = "../edgeR_diff_expression/Exc_All/Exc_all_filtByExpr_edgeR_DE_QLFTest.csv"
path_to_rosmap_clin = "../ROSMAP_metadata/cleaned_rosmapmeta_n409.csv"
metabolon_filename = "../metabolic_data/ROSMAP_Metabolon_HD4_Brain514_assay_data.csv"
metabolon_datakey = "../metabolic_data/ROSMAP_Metabolon_HD4_Data_Dictionary.csv"
#BHQ corrected p cutoff to be considered cycling in analysis:
isCyclingBHQCutoff = 0.1
percentile = 0.
useBatch = T
#Ribosome genes
plot_me = c("RPL18","RPS7","RPL22","RPS18","RPL8","RPL10A","RPS13","RPL14","RPS15A","RPS12","RPL36AL","RPL34","RPL30","RPL9","RPL21","RPS28","RPSA","RPL26","RPL27A","FAU","RPS3A","RPL7A","RPL17","RPS27A","RPS16","RPL15","RPLP1","RPL7","RPL10","RPL23A","RPL18A","RPL3","RPL12","RPL39","RPL37A","RPL37","RPS10","RPL13","RPL35A","RPS23","RPL13A","RPL38","RPS29","RPL24","RPL41","RPL35","RPS26","RPS2","RPS9","RPL32","RPL6","RPS21","RPS24","RPS25","RPL36","RPL19","RPS27","RPL29","RPS15","RPS3","RPS5","RPS8","RPL27","RSL24D1","RPS6","RPL11")
#Add oxphos genes
plot_me = c(plot_me, "ATP6V1G1","UQCR10","NDUFA5","NDUFA4" ,"COX6CP3",   "PPA2","ATP5MF","NDUFS7", "MT-CYB", "ATP6V0A1","ATP6V1G2","ATP6V0B", "ATP5PO","MT-CO2","MT-CO1","ATP6AP1","COX8C","MT-CO3" ,"COX5B", "COX4I1",  "ATP6V0A4" ,"ATP12A","MT-ATP6","MT-ATP8" ,"ATP5PD", "NDUFA2","NDUFA3",    "NDUFA1", "ATP5MC1P5","UQCRQ","ATP6V1H","ATP5F1D"  ,"LHPP","ATP6V0D2" ,"COX7A2L" ,"ATP5MC3","ATP6V1C2","ATP5MC2" ,"ATP5MC1" ,"ATP5PB" ,"ATP5F1E", "COX5A" ,"TCIRG1","UQCRHL" ,"ATP4B" ,"ATP6V1D" )
plot_me = c("ARNTL", "APOE")
plot_genes(path_to_tmm_file, path_to_cyclops_ordering, plot_me,useBatch = useBatch, percentile = percentile, split_cond_plots = T)
plot_genes(path_to_tmm_file, path_to_cyclops_ordering, plot_me,useBatch = useBatch, percentile = percentile, split_cond_plots = F, save_pdf = T)
plot_me = c("RPS6", "RPL7A", "RPS27A", "RPL10A")
plot_genes(path_to_tmm_file, path_to_cyclops_ordering, plot_me,useBatch = useBatch, percentile = percentile, split_cond_plots = F, save_pdf = T)
load("/Users/henryhollis/Box Sync/Henry_stuff/AD_project/scROSMAP/scrosmap_newAtlas/scROSMAP_project/BestSubclusters_server_Exc.rda")
View(grid_results)
grid_results[["values"]]
